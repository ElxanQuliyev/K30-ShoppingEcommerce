@model P109_ShoppingCommerce.ViewModels.ProductDetailVM
@using P109_ShoppingCommerce.Models
@{
    ViewBag.Title = "Details";
}

<div class="container-fluid">
    <div class="row bg-dark text-light">
        <div class="col-3">
            <img src="~/Images/@Model.Product.Image" class="rounded-circle" style="height: 300px; object-fit: cover;" />
        </div>
        <div class="col-9 d-flex flex-column justify-content-around align-items-center">

            <h4>@Model.Product.ProductName - @Model.Product.Category.CategoryName</h4>
            <h5>Price: @Model.Product.Price AZN</h5>
            @if (Session["user"] == null)
            {
                <a style="color: #e29090" href="/Account/Login">Please, login to add this item to your basket.</a>
            }
            else
            {
                var basket = Session["basket"] as List<BasketProduct>;
                if (basket == null || !basket.Any(p => p.Product.Id == Model.Product.Id))
                {
                    <a class="btn btn-primary btn-lg" href="/Orders/AddToBasket/@Model.Product.Id"><i class="fas fa-shopping-cart mr-3"></i> Add to basket</a>
                }
                else
                {
                    <a class="btn btn-danger btn-lg" href="/Orders/RemoveFromBasket/@Model.Product.Id"><i class="fas fa-trash"></i> Remove from basket</a>
                }
            }
        </div>
    </div>

    <div class="row mt-5">
        <div class="col">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    @{ int i = 0;}
                    @foreach (var item in Model.Product.ProductImages)
                    {
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <img height="500" src="~/Images/@item.Image" class="d-block w-100">
                        </div>
                        @(i++)
                    }
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

        </div>
    </div>
</div>


@section right_aside{
    <div class="sticky-top" style="padding-top: 50px">
        <h4 class="text-info mb-3">Related Products</h4>
        <ul class="list-group">
            @foreach (var item in Model.RelatedProducts)
            {
                <li class="list-group-item">
                    <a href="/Products/Details/@item.Id">
                        <div class="row">
                            <div class="col-6">
                                <img src="~/Images/@item.Image" width="50" class="rounded-circle" />
                            </div>
                            <div class="col-6">
                                <p>@item.ProductName</p>
                            </div>
                        </div>
                    </a>
                </li>
            }
        </ul>
    </div>
}

@section scripts{
    <script>
        //$(".basketPro .up").each(function () {
        //    $(this).click(function () {
        //        var price = 1000 //.text();
        //        var count = 3//.val();
        //        var total = price * count;

        //    })
        //})
    </script>    
}